# パケット仕様
## 基本構造
1byte中、先頭3ビットをIDとして使う。後ろ5ビットをパターンとして使う。
IDはデバイスごとに決め打ちにする。
また、後ろ5ビット中先頭2ビットを点滅・グローのフラグにし、残りを色のIDに割り当てる。

````
|----3bit-----|----5bit----|
|--Device ID--|---Pattern--|
````

Master・Slaveともにこのパケット仕様で通信を行う。
よって、アプリからもこの形式でMasterにデータを送る。

### Device ID
デバイスIDはファームウェアに直接書き込まれている。
000〜111までの8個。000はMaster、その他はSlave。

### Pattern
````
|--2bit--|-----3bit------|
|--Flag--|---Pattern ID--|
````

グローの立ち上がりは0.5秒、点滅の周期は1秒とする。

- Flag
	- 点灯するパターンを示す。
		- 00...点灯（グロー）
		- 01...グロー+点滅
		- 10...未定義
		- 11...消灯
- Pattern ID
	- 点灯する色を示す。
		- 000...Red
		- 001...Blue
		- 010...Green
		- 011...Orange
		- 100...Yellow
		- 101...Purple
		- 110...Indigo
		- 111...White

# 伝搬アルゴリズム

考慮すべきこととして、どうタイミングを合わせてデバイスを駆動させるか。
また、どのポートからパケットをフォワードするかを考える必要がある。

デバイスは3つのポートを常に監視する。
監視のタイミングが微妙にずれた時、パケットを受信できるかは要検証。（複数のポートが同時に通信することができるか？）